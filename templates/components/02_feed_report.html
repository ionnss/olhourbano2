{{define "feed_report"}}
<div class="report-card" data-report-id="{{.ID}}">
    <div class="report-card-header">
        <div class="report-category">
            <span class="category-icon">{{.CategoryIcon}}</span>
            <span class="category-name">{{.CategoryName}}</span>
        </div>
        <div class="report-status">
            <span class="status-badge status-{{.Status}}">{{.StatusText}}</span>
        </div>
    </div>

    <div class="report-card-body">
        <!-- Location -->
        <div class="report-location mb-3">
            <i class="bi bi-geo-alt-fill text-muted me-2"></i>
            <span class="location-text">{{.Location}}</span>
        </div>

        <!-- Description -->
        <div class="report-description mb-3">
            <p class="description-text">{{.Description}}</p>
        </div>

        <!-- Transport Info (if available) -->
        {{if .TransportType}}
        <div class="report-transport mb-3">
            <div class="transport-info">
                <i class="bi bi-bus-front text-muted me-2"></i>
                <span class="transport-type">{{.TransportTypeName}}</span>
                {{if .TransportDetails}}
                <div class="transport-details mt-1">
                    <small class="text-muted">{{.TransportDetails}}</small>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}

        <!-- Photos/Videos Preview -->
        {{if and .PhotoPath (gt (len .Photos) 0)}}
        <div class="report-media mb-3">
            <div class="media-preview">
                {{range $index, $photo := .Photos}}
                {{if $photo}}
                <div class="media-item" onclick="openFileModal('/{{$photo}}', '{{$photo}}', '{{getFileType $photo}}')" style="cursor: pointer;">
                    {{if isImageFile $photo}}
                        <!-- Image file - show actual image -->
                        <img src="/{{$photo}}" alt="Evidência {{add $index 1}}" class="media-thumbnail" loading="lazy">
                    {{else if isVideoFile $photo}}
                        <!-- Video file - show thumbnail or icon -->
                        {{$thumbnailPath := getThumbnailPath $photo}}
                        {{if $thumbnailPath}}
                            <img src="/thumbnails/{{getThumbnailFilename $photo}}" alt="Vídeo {{add $index 1}}" class="media-thumbnail" loading="lazy">
                        {{else}}
                            <div class="media-thumbnail media-icon-thumbnail">
                                <i class="bi bi-camera-video-fill"></i>
                            </div>
                        {{end}}
                    {{else if isPdfFile $photo}}
                        <!-- PDF file - show thumbnail or icon -->
                        {{$thumbnailPath := getThumbnailPath $photo}}
                        {{if $thumbnailPath}}
                            <img src="/thumbnails/{{getThumbnailFilename $photo}}" alt="PDF {{add $index 1}}" class="media-thumbnail" loading="lazy">
                        {{else}}
                            <div class="media-thumbnail media-icon-thumbnail">
                                <i class="bi bi-file-pdf-fill"></i>
                            </div>
                        {{end}}
                    {{else}}
                        <!-- Other document types - show icon -->
                        <div class="media-thumbnail media-icon-thumbnail">
                            <i class="bi {{getFileTypeIcon $photo}}"></i>
                        </div>
                    {{end}}
                    <div class="media-overlay-hover">
                        <i class="bi bi-eye-fill"></i>
                    </div>
                </div>
                {{end}}
                {{end}}
            </div>
        </div>
        {{end}}
    </div>

    <div class="report-card-footer">
        <div class="report-meta">
            <div class="meta-item">
                <i class="bi bi-calendar3 text-muted me-1"></i>
                <span class="meta-text">{{.CreatedAt}}</span>
            </div>
            <div class="meta-item">
                <i class="bi bi-eye-fill text-muted me-1"></i>
                <span class="meta-text">OlhoUrbano{{.HashedCPFDisplay}}</span>
            </div>
            {{if gt .CommentCount 0}}
            <div class="meta-item">
                <i class="bi bi-chat-dots text-muted me-1"></i>
                <span class="meta-text">{{.CommentCount}} comentário{{if ne .CommentCount 1}}s{{end}}</span>
            </div>
            {{end}}
        </div>

        <div class="report-actions">
            <a href="/report/{{.ID}}" class="btn action-btn btn-sm">
                <i class="bi bi-eye-fill me-1"></i>
                Ver Detalhes
            </a>
            <button class="btn action-btn btn-sm vote-btn" data-report-id="{{.ID}}">
                <i class="bi bi-hand-thumbs-up-fill me-1"></i>
                Votar
                <span class="vote-shield">
                    <span class="vote-count">{{.VoteCount}}</span>
                </span>
            </button>
        </div>
    </div>
</div>
{{end}}